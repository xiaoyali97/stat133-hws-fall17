library(XML)
library(xml2)
library(rvest)
library(magrittr)
basket <- "https://www.basketball-reference.com"
gsw <- "/teams/GSW/2017.html"
gsw_url <- paste0(basket, gsw)
download.file(gsw_url, 'gsw-roster-2017.html')
gsw_roster <- readHTMLTable('gsw-roster-2017.html')
gsw_roster
nba_html <- paste0(basket, "/leagues/NBA_2017.html")
xml_doc <- read_html(nba_html)
xml_text <- xml_doc %>% html_text()
xml_text
xml_doc
head(xml_doc)
head(xml_text)
xml_doc %>%
html_nodes("h2") %>%
html_text()
library(shiny); runApp('~/UC_Berkeley/Stat133/stat133-hws-fall17/hw04/app/gradevis.R')
xml_doc %>%
html_nodes("h2") %>%
html_text()
xml_doc %>%
html_node("h1") %>%
html_text()
library(XML)
library(xml2)
library(rvest)
library(magrittr)
#read the contents of the html file
nba_html <- paste0(basket, "/leagues/NBA_2017.html")
xml_doc <- read_html(nba_html)
xml_text <- xml_doc %>% html_text()
# content of h2 nodes
xml_doc %>%
html_nodes("h2") %>%
html_text()
#h1
xml_doc %>%
html_node("h1") %>%
html_text()
#strong
xml_doc %>%
html_node("strong") %>%
html_text()
#button
xml_doc %>%
html_node("button") %>%
html_text()
#strong
xml_doc %>%
html_node("strong") %>%
html_text()
library(XML)
library(xml2)
library(rvest)
library(magrittr)
# Assemble url (so it fits on screen)
basket <- "https://www.basketball-reference.com"
gsw <- "/teams/GSW/2017.html"
gsw_url <- paste0(basket, gsw)
# download HTML file to your working directory
download.file(gsw_url, 'gsw-roster-2017.html')
# Read GSW Roster html table
gsw_roster <- readHTMLTable('gsw-roster-2017.html')
gsw_roster
# Assemble url (so it fits on screen)
basket <- "https://www.basketball-reference.com"
bos <- "/teams/BOS/2017.html"
bos_url <- paste0(basket, bos)
# download HTML file to your working directory
download.file(bos_url, 'bos-roster-2017.html')
# Read BOS Roster html table
bos_roster <- readHTMLTable('bos-roster-2017.html')
#read the contents of the html file
nba_html <- paste0(basket, "/leagues/NBA_2017.html")
xml_doc <- read_html(nba_html)
xml_text <- xml_doc %>% html_text()
# content of h2 nodes
xml_doc %>%
html_nodes("h2") %>%
html_text()
#h1
xml_doc %>%
html_node("h1") %>%
html_text()
#strong
xml_doc %>%
html_node("strong") %>%
html_text()
#button
xml_doc %>%
html_node("button") %>%
html_text()
#strong
xml_doc %>%
html_nodes("strong") %>%
html_text()
#button
xml_doc %>%
html_nodes("button") %>%
html_text()
#h1
xml_doc %>%
html_nodes("h1") %>%
html_text()
# node with an attribute
xml_doc %>%
html_nodes("p.listhead") %>%
html_text()
xml_doc %>%
html_nodes(xpath = '//p[@class="listhead"]') %>%
html_text()
xml_doc %>%
html_nodes(xpath = '//ul[@class=""]/li/a') %>%
html_text()
xml_doc %>%
html_nodes(xpath = '//ul[@class=""]//a') %>%
html_text()
# extracting first table
xml_table1 <- xml_doc %>%
html_nodes("table") %>%
extract(1)
class(xml_table1)
tbl1 <- html_table(xml_table1)
head(tbl1)
# extracting second table
xml_table2 <- xml_doc %>%
html_nodes("table") %>%
extract(2)
# two html tables
xml_tables <- xml_doc %>%
html_nodes("table") %>%
extract(1:2)
# extract names of teams
xml_tables %>%
html_nodes("a") %>%
html_text()
xml_tables %>%
html_nodes("a") %>%
html_attr("href")
hrefs <- xml_tables %>%
html_nodes("a") %>%
html_attr("href")
library(stringr)
teams <- str_sub(hrefs, start = 8, end = 10)
teams
files <- paste0(teams, "-roster-2017.csv")
files
# modify with `hrefs[1]`
basket <- "https://www.basketball-reference.com"
gsw_url <- paste0(basket, hrefs[1])
team_url <- read_html(team_url)
# modify with `hrefs[1]`
basket <- "https://www.basketball-reference.com"
team_url <- paste0(basket, hrefs[1])
team_url <- read_html(team_url)
roster <- html_table(team_url)
?write.csv
write.csv(x = roster, file = "BOS-roster-2017.csv")
write.csv(x = roster, file = "BOS-roster-2017.csv", row.names = FALSE)
for(i in 10:15){
team_url <- paste0(basket, hrefs[i])
team_html <- read_html(team_url)
roster <- html_table(team_html)
write.csv(x = roster, file = files[i], row.names = FALSE)
}
team_csv <- read.csv(files[10], stringsAsFactors = FALSE)
head(team_csv)
team_csv <- read.csv(files[10], stringsAsFactors = FALSE, row.names = FALSE)
team_csv <- read.csv(files[10], stringsAsFactors = FALSE)
head(team_csv)
team_name <- str_sub(files[10], start = 1, end = 3)
team_name
head(team_csv)
team_csv$Team <- rep(team_name, nrow(team_csv))
head(team_csv)
global <- data.frame()
merge.data.frame()
?
s
?merge.data.frame()
global <- merge.data.frame(global, team_csv)
global
team_csv
global <- merge.data.frame(global, team_csv, all = TRUE)
global
global <- data.frame()
for(i in 10:15){
team_csv <- read.csv(files[i], stringsAsFactors = FALSE)
team_name <- str_sub(files[i], start = 1, end = 3)
team_csv$Team <- rep(team_name, nrow(team_csv))
global <- merge.data.frame(global, team_csv, all = TRUE)
}
global
global <- data.frame()
for(i in 10:15){
team_csv <- read.csv(files[i], stringsAsFactors = FALSE)
team_name <- str_sub(files[i], start = 1, end = 3)
team_csv$Team <- rep(team_name, nrow(team_csv))
global <- merge.data.frame(global, team_csv, all = TRUE, sort = FALSE)
}
global
global <- data.frame()
for(i in 10:15){
team_csv <- read.csv(files[i], stringsAsFactors = FALSE)
team_name <- str_sub(files[i], start = 1, end = 3)
team_csv$Team <- rep(team_name, nrow(team_csv))
global <- merge.data.frame(global, team_csv, all = TRUE, sort = FALSE)
}
global
write.csv(global, file = "nba-rosters-2017.csv", row.names = FALSE)
